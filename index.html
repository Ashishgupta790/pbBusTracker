<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Punjab Bus Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .logo-text {
            font-family: 'Orbitron', monospace;
            background: linear-gradient(45deg, #FFD700, #FFA500, #FF6B35, #FF1744);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientShift 3s ease-in-out infinite;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
            transition: all 0.3s ease;
        }
        
        .logo-text:hover {
            transform: scale(1.05);
            text-shadow: 0 0 40px rgba(255, 215, 0, 0.8), 0 0 60px rgba(255, 165, 0, 0.6);
            filter: brightness(1.2);
        }
        
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .hover-lift {
            transition: all 0.3s ease;
        }
        
        .hover-lift:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .slide-in {
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Dark Mode Styles */
        .dark-mode {
            filter: invert(1) hue-rotate(180deg);
        }
        
        .dark-mode img,
        .dark-mode video,
        .dark-mode iframe,
        .dark-mode svg {
            filter: invert(1) hue-rotate(180deg);
        }
    </style>
</head>
<body class="min-h-screen gradient-bg">


    <!-- Dark Mode Toggle -->
    <div class="fixed bottom-4 right-4 z-50">
        <button id="darkModeToggle" class="bg-white/20 hover:bg-white/30 text-white p-3 rounded-full backdrop-blur-md transition-all duration-300 hover-lift">
            <i class="fas fa-moon text-xl"></i>
        </button>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer" class="fixed top-4 left-1/2 transform -translate-x-1/2 z-50 space-y-2"></div>

    <!-- Header with Login -->
    <header class="glass-effect border-b border-white/20 p-4">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <i class="fas fa-bus text-white text-3xl"></i>
                <div>
                    <h1 class="logo-text text-2xl font-bold cursor-pointer" data-translate="title">Punjab Bus Tracker</h1>
                    <div class="flex items-center space-x-4 text-white/80 text-sm mt-1">
                        <div class="flex items-center space-x-1">
                            <i class="fas fa-calendar-alt text-xs"></i>
                            <span id="currentDate"></span>
                        </div>
                        <div class="flex items-center space-x-1">
                            <i class="fas fa-clock text-xs"></i>
                            <span id="currentTime"></span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="flex items-center space-x-4">
                <!-- Language Selector -->
                <select id="languageSelector" class="bg-black/20 text-white border border-white/30 rounded-lg px-3 py-2 backdrop-blur-md hover:bg-black/80 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-blue-400">
                    <option value="en">üá∫üá∏ English</option>
                    <option value="hi">üáÆüá≥ ‡§π‡§ø‡§Ç‡§¶‡•Ä</option>
                    <option value="pa">üáÆüá≥ ‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä</option>
                </select>
                

                
                <!-- Login Button -->
                <button onclick="showLoginOptions()" class="bg-white/20 hover:bg-white/30 text-white px-6 py-2 rounded-lg transition-all duration-300 hover-lift">
                    <i class="fas fa-sign-in-alt mr-2"></i>
                    <span data-translate="login">Login</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Bus Tracking Section -->
        <div class="grid md:grid-cols-2 gap-8 mb-8">
            <!-- Track by Route -->
            <div class="bg-purple-500 p-6 hover-lift fade-in">
                <h2 class="text-white text-xl font-semibold mb-6 flex items-center">
                    <i class="fas fa-route mr-3 text-blue-300"></i>
                    <span data-translate="trackByRoute">Track by Route</span>
                </h2>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-white/80 mb-2" data-translate="pickup">Pickup Location</label>
                        <select id="pickupLocation" class="w-full bg-white/10 border border-white/30 rounded-lg px-4 py-3 text-black placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-300">
                            <option value="" data-translate="selectPickup">Select Pickup Location</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-white/80 mb-2" data-translate="drop">Drop Location</label>
                        <select id="dropLocation" class="w-full bg-white/10 border border-white/30 rounded-lg px-4 py-3 text-black placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-300">
                            <option value="" data-translate="selectDrop">Select Drop Location</option>
                        </select>
                    </div>
                    
                    <!-- Date & Time Selector -->
                    <div>
                        <label class="block text-white/80 mb-2" data-translate="selectDateTime">Select Date & Time</label>
                        <button onclick="showJourneyDateSelector()" class="w-full bg-white/10 hover:bg-white/20 border border-white/30 rounded-lg px-4 py-3 text-black text-left transition-all duration-300 hover-lift flex items-center justify-between">
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-calendar-alt text-blue-400"></i>
                                <div>
                                    <div class="text-sm font-medium" id="selectedJourneyDate" data-translate="selectDate">Select Date</div>
                                    <div class="text-xs opacity-80" id="selectedJourneyTime" data-translate="selectTime">Select Time</div>
                                </div>
                            </div>
                            <i class="fas fa-chevron-right text-white/60"></i>
                        </button>
                    </div>
                    
                    <button onclick="trackByRoute()" class="w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-semibold py-3 rounded-lg transition-all duration-300 transform hover:scale-105">
                        <i class="fas fa-search mr-2"></i>
                        <span data-translate="findBuses">Find Buses</span>
                    </button>
                </div>
            </div>

            <!-- Track by Bus Number -->
            <div class="bg-purple-600 rounded-2xl p-6 hover-lift fade-in">
                <h2 class="text-white text-xl font-semibold mb-6 flex items-center">
                    <i class="fas fa-hashtag mr-3 text-green-300"></i>
                    <span data-translate="trackByNumber">Track by Bus Number</span>
                </h2>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-white/80 mb-2" data-translate="busNumber">Bus Number</label>
                        <input type="text" id="busNumberInput" placeholder="Enter bus number (e.g., PB-01-1234)" class="w-full bg-white/10 border border-white/30 rounded-lg px-4 py-3 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-green-400 transition-all duration-300">
                    </div>
                    
                    <!-- Date & Time Selector -->
                    <div>
                        <label class="block text-white/80 mb-2" data-translate="selectDateTime">Select Date & Time</label>
                        <button onclick="showJourneyDateSelector()" class="w-full bg-white/10 hover:bg-white/20 border border-white/30 rounded-lg px-4 py-3 text-white text-left transition-all duration-300 hover-lift flex items-center justify-between">
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-calendar-alt text-green-400"></i>
                                <div>
                                    <div class="text-sm font-medium" id="selectedJourneyDate2" data-translate="selectDate">Select Date</div>
                                    <div class="text-xs opacity-80" id="selectedJourneyTime2" data-translate="selectTime">Select Time</div>
                                </div>
                            </div>
                            <i class="fas fa-chevron-right text-white/60"></i>
                        </button>
                    </div>
                    
                    <button onclick="trackByNumber()" class="w-full bg-gradient-to-r from-green-500 to-teal-600 hover:from-green-600 hover:to-teal-700 text-white font-semibold py-3 rounded-lg transition-all duration-300 transform hover:scale-105">
                        <i class="fas fa-map-marker-alt mr-2"></i>
                        <span data-translate="trackBus">Track Bus</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Quick Actions Section -->
        <div class="grid md:grid-cols-2 gap-8 mb-8">
            <!-- Recent Searches -->
            <div class="glass-effect rounded-2xl p-6 hover-lift fade-in">
                <h2 class="text-white text-xl font-semibold mb-6 flex items-center">
                    <i class="fas fa-history mr-3 text-purple-300"></i>
                    <span data-translate="recentSearches">Recent Searches</span>
                </h2>
                
                <div id="recentSearchesList" class="space-y-3">
                    <div class="text-center text-white/60 py-8">
                        <i class="fas fa-search text-3xl mb-3"></i>
                        <p data-translate="noRecentSearches">No recent searches yet</p>
                        <p class="text-sm mt-2" data-translate="searchToSave">Search for buses to see them here</p>
                    </div>
                </div>
                
                <button onclick="clearRecentSearches()" class="w-full mt-4 bg-white/10 hover:bg-white/20 text-white font-medium py-2 rounded-lg transition-all duration-300 hover-lift text-sm" style="display: none;" id="clearRecentBtn">
                    <i class="fas fa-trash mr-2"></i>
                    <span data-translate="clearHistory">Clear History</span>
                </button>
            </div>

            <!-- Recommended Routes -->
            <div class="bg-purple-600 rounded-2xl p-6 hover-lift fade-in">
                <h2 class="text-white text-xl font-semibold mb-6 flex items-center">
                    <i class="fas fa-star mr-3 text-yellow-300"></i>
                    <span data-translate="recommendedRoutes">Recommended Routes</span>
                </h2>
                
                <div class="space-y-3">
                    <div class="bg-white/10 hover:bg-white/20 rounded-lg p-3 cursor-pointer transition-all duration-300 hover-lift" onclick="selectRecommendedRoute('Chandigarh', 'Ludhiana')">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-white font-medium">Chandigarh ‚Üí Ludhiana</p>
                                <p class="text-white/70 text-sm">Popular route ‚Ä¢ 98 km</p>
                            </div>
                            <div class="text-right">
                                <p class="text-green-400 font-semibold">‚Çπ120</p>
                                <p class="text-white/60 text-xs">5 buses available</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white/10 hover:bg-white/20 rounded-lg p-3 cursor-pointer transition-all duration-300 hover-lift" onclick="selectRecommendedRoute('Chandigarh', 'Amritsar')">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-white font-medium">Chandigarh ‚Üí Amritsar</p>
                                <p class="text-white/70 text-sm">Frequent service ‚Ä¢ 230 km</p>
                            </div>
                            <div class="text-right">
                                <p class="text-green-400 font-semibold">‚Çπ280</p>
                                <p class="text-white/60 text-xs">3 buses available</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white/10 hover:bg-white/20 rounded-lg p-3 cursor-pointer transition-all duration-300 hover-lift" onclick="selectRecommendedRoute('Ludhiana', 'Amritsar')">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-white font-medium">Ludhiana ‚Üí Amritsar</p>
                                <p class="text-white/70 text-sm">Express route ‚Ä¢ 132 km</p>
                            </div>
                            <div class="text-right">
                                <p class="text-green-400 font-semibold">‚Çπ160</p>
                                <p class="text-white/60 text-xs">4 buses available</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button onclick="showAllRecommendations()" class="w-full mt-4 bg-gradient-to-r from-yellow-500 to-orange-600 hover:from-yellow-600 hover:to-orange-700 text-white font-semibold py-2 rounded-lg transition-all duration-300 transform hover:scale-105">
                    <i class="fas fa-route mr-2"></i>
                    <span data-translate="viewAllRoutes">View All Routes</span>
                </button>
            </div>
        </div>

        <!-- Bus Results -->
        <div id="busResults" class="hidden glass-effect rounded-2xl p-6 fade-in">
            <h2 class="text-white text-xl font-semibold mb-4 flex items-center">
                <i class="fas fa-list mr-3 text-orange-300"></i>
                <span data-translate="availableBuses">Available Buses</span>
            </h2>
            <div id="busList" class="space-y-4"></div>
        </div>
    </main>

    <!-- Login Options Modal -->
    <div id="loginOptionsModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="glass-effect rounded-2xl p-8 m-4 w-full max-w-md slide-in">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-white text-2xl font-semibold" data-translate="selectLoginType">Select Login Type</h2>
                <button onclick="closeLoginOptions()" class="text-white/60 hover:text-white transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="space-y-4">
                <button onclick="showLogin('admin')" class="w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-semibold py-4 rounded-lg transition-all duration-300 transform hover:scale-105 hover-lift">
                    <i class="fas fa-user-shield mr-3 text-xl"></i>
                    <span data-translate="adminPortal">Admin Portal</span>
                </button>
                
                <button onclick="showLogin('driver')" class="w-full bg-gradient-to-r from-green-500 to-teal-600 hover:from-green-600 hover:to-teal-700 text-white font-semibold py-4 rounded-lg transition-all duration-300 transform hover:scale-105 hover-lift">
                    <i class="fas fa-id-card mr-3 text-xl"></i>
                    <span data-translate="driverPortal">Driver Portal</span>
                </button>
                
                <div class="border-t border-white/20 pt-4 mt-6">
                    <p class="text-white/70 text-center mb-4" data-translate="newUser">New User?</p>
                    <div class="grid grid-cols-2 gap-3">
                        <button onclick="showCreateAccount('admin')" class="bg-white/10 hover:bg-white/20 text-white font-medium py-3 px-4 rounded-lg transition-all duration-300 hover-lift text-sm">
                            <i class="fas fa-user-plus mr-2"></i>
                            <span data-translate="createAdmin">Create Admin</span>
                        </button>
                        
                        <button onclick="showCreateAccount('driver')" class="bg-white/10 hover:bg-white/20 text-white font-medium py-3 px-4 rounded-lg transition-all duration-300 hover-lift text-sm">
                            <i class="fas fa-user-plus mr-2"></i>
                            <span data-translate="createDriver">Create Driver</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="glass-effect rounded-2xl p-8 m-4 w-full max-w-md slide-in">
            <div class="flex justify-between items-center mb-6">
                <h2 id="loginTitle" class="text-white text-2xl font-semibold"></h2>
                <button onclick="closeLogin()" class="text-white/60 hover:text-white transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-white/80 mb-2" data-translate="username">Username</label>
                    <input type="text" id="username" class="w-full bg-white/10 border border-white/30 rounded-lg px-4 py-3 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-300">
                </div>
                
                <div>
                    <label class="block text-white/80 mb-2" data-translate="password">Password</label>
                    <div class="relative">
                        <input type="password" id="password" class="w-full bg-white/10 border border-white/30 rounded-lg px-4 py-3 pr-12 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-300">
                        <button type="button" id="togglePassword" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-white/60 hover:text-white transition-colors hidden" onclick="togglePasswordVisibility('password', 'togglePassword')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <button type="submit" class="w-full bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white font-semibold py-3 rounded-lg transition-all duration-300 transform hover:scale-105">
                    <i class="fas fa-sign-in-alt mr-2"></i>
                    <span data-translate="login">Login</span>
                </button>
            </form>
            
            <div class="mt-4 text-center text-white/60 text-sm">
                <p data-translate="demoCredentials">Demo Credentials:</p>
                <p>Admin: admin1 / admin123</p>
                <p>Driver: driver1 / pass123</p>
            </div>
        </div>
    </div>

    <!-- Dashboard Modal -->
    <div id="dashboardModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="glass-effect rounded-2xl p-8 m-4 w-full max-w-4xl max-h-[90vh] overflow-y-auto slide-in">
            <div class="flex justify-between items-center mb-6">
                <h2 id="dashboardTitle" class="text-white text-2xl font-semibold"></h2>
                <button onclick="closeDashboard()" class="text-white/60 hover:text-white transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div id="dashboardContent" class="text-white"></div>
        </div>
    </div>

    <!-- Create Account Modal -->
    <div id="createAccountModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="glass-effect rounded-2xl p-8 m-4 w-full max-w-lg max-h-[90vh] overflow-y-auto slide-in">
            <div class="flex justify-between items-center mb-6">
                <h2 id="createAccountTitle" class="text-white text-2xl font-semibold"></h2>
                <button onclick="closeCreateAccount()" class="text-white/60 hover:text-white transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="createAccountForm" class="space-y-4">
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-white/80 mb-2" data-translate="fullName">Full Name *</label>
                        <input type="text" id="createName" required class="w-full bg-white/10 border border-white/30 rounded-lg px-4 py-3 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-300">
                    </div>
                    
                    <div>
                        <label class="block text-white/80 mb-2" data-translate="age">Age *</label>
                        <input type="number" id="createAge" min="18" max="65" required class="w-full bg-white/10 border border-white/30 rounded-lg px-4 py-3 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-300">
                    </div>
                </div>
                
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-white/80 mb-2" data-translate="gender">Gender *</label>
                        <select id="createGender" required class="w-full bg-white/10 border border-white/30 rounded-lg px-4 py-3 text-black focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-300">
                            <option value="" data-translate="selectGender">Select Gender</option>
                            <option value="male" data-translate="male">Male</option>
                            <option value="female" data-translate="female">Female</option>
                            <option value="other" data-translate="other">Other</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-white/80 mb-2" data-translate="mobile">Mobile Number *</label>
                        <input type="tel" id="createMobile" pattern="[0-9]{10}" required class="w-full bg-white/10 border border-white/30 rounded-lg px-4 py-3 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-300" placeholder="10-digit number">
                    </div>
                </div>
                
                <div>
                    <label class="block text-white/80 mb-2" data-translate="email">Email (Optional)</label>
                    <input type="email" id="createEmail" class="w-full bg-white/10 border border-white/30 rounded-lg px-4 py-3 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-300" placeholder="example@email.com">
                </div>
                
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-white/80 mb-2" data-translate="username">Username *</label>
                        <input type="text" id="createUsername" required class="w-full bg-white/10 border border-white/30 rounded-lg px-4 py-3 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-300">
                    </div>
                    
                    <div>
                        <label class="block text-white/80 mb-2" data-translate="password">Password *</label>
                        <div class="relative">
                            <input type="password" id="createPassword" required minlength="6" class="w-full bg-white/10 border border-white/30 rounded-lg px-4 py-3 pr-12 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-300">
                            <button type="button" id="toggleCreatePassword" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-white/60 hover:text-white transition-colors hidden" onclick="togglePasswordVisibility('createPassword', 'toggleCreatePassword')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="driverSpecificFields" class="hidden space-y-4">
                    <div class="border-t border-white/20 pt-4">
                        <h3 class="text-white font-semibold mb-3" data-translate="driverInfo">Driver Information</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-white/80 mb-2" data-translate="licenseNumber">License Number</label>
                                <input type="text" id="createLicense" class="w-full bg-white/10 border border-white/30 rounded-lg px-4 py-3 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-300">
                            </div>
                            
                            <div>
                                <label class="block text-white/80 mb-2" data-translate="experience">Experience (Years)</label>
                                <input type="number" id="createExperience" min="0" max="50" class="w-full bg-white/10 border border-white/30 rounded-lg px-4 py-3 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-300">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="adminSpecificFields" class="hidden space-y-4">
                    <div class="border-t border-white/20 pt-4">
                        <h3 class="text-white font-semibold mb-3" data-translate="adminInfo">Admin Information</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-white/80 mb-2" data-translate="department">Department</label>
                                <select id="createDepartment" class="w-full bg-white/10 border border-white/30 rounded-lg px-4 py-3 text-black focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-300">
                                    <option value="" data-translate="selectDepartment">Select Department</option>
                                    <option value="operations">Operations</option>
                                    <option value="fleet">Fleet Management</option>
                                    <option value="customer">Customer Service</option>
                                    <option value="maintenance">Maintenance</option>
                                    <option value="planning">Route Planning</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-white/80 mb-2" data-translate="level">Level</label>
                                <select id="createLevel" class="w-full bg-white/10 border border-white/30 rounded-lg px-4 py-3 text-black focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-300">
                                    <option value="" data-translate="selectLevel">Select Level</option>
                                    <option value="junior">Junior</option>
                                    <option value="senior">Senior</option>
                                    <option value="supervisor">Supervisor</option>
                                    <option value="manager">Manager</option>
                                    <option value="head">Head</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="w-full bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white font-semibold py-3 rounded-lg transition-all duration-300 transform hover:scale-105 mt-6">
                    <i class="fas fa-user-plus mr-2"></i>
                    <span data-translate="createAccount">Create Account</span>
                </button>
            </form>
        </div>
    </div>

    <!-- Journey Date & Time Selector Modal -->
    <div id="journeyDateModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="glass-effect rounded-2xl p-6 m-4 w-full max-w-sm slide-in">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-white text-lg font-semibold flex items-center">
                    <i class="fas fa-calendar-alt mr-2 text-blue-400"></i>
                    <span data-translate="selectDateTime">Select Date & Time</span>
                </h2>
                <button onclick="closeJourneyDateSelector()" class="text-white/60 hover:text-white transition-colors">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="space-y-4">
                <!-- Date Selection -->
                <div>
                    <label class="block text-white/80 mb-2 text-sm" data-translate="selectDate">Select Date</label>
                    <input type="date" id="journeyDateInput" class="w-full bg-white/10 border border-white/30 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-300">
                </div>
                
                <!-- Time Selection -->
                <div>
                    <label class="block text-white/80 mb-2 text-sm" data-translate="selectTime">Select Time</label>
                    <input type="time" id="customTimeInput" class="w-full bg-white/10 border border-white/30 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-300">
                </div>
                
                <!-- Action Buttons -->
                <div class="flex space-x-2 pt-2">
                    <button onclick="confirmJourneyDateTime()" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 rounded-lg transition-all duration-300">
                        <i class="fas fa-check mr-1"></i>
                        <span data-translate="confirm">Confirm</span>
                    </button>
                    <button onclick="closeJourneyDateSelector()" class="bg-white/10 hover:bg-white/20 text-white px-4 py-2 rounded-lg transition-all duration-300">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bus Details Modal -->
    <div id="busDetailsModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="glass-effect rounded-2xl p-8 m-4 w-full max-w-6xl max-h-[90vh] overflow-y-auto slide-in">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-white text-2xl font-semibold" data-translate="busDetails">Bus Details</h2>
                <button onclick="closeBusDetails()" class="text-white/60 hover:text-white transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div id="busDetailsContent" class="text-white"></div>
        </div>
    </div>

    <script>
        // Language translations
        const translations = {
            en: {
                title: "Punjab Bus Tracker",
                admin: "Admin",
                driver: "Driver",
                trackByRoute: "Track by Route",
                trackByNumber: "Track by Bus Number",
                pickup: "Pickup Location",
                drop: "Drop Location",
                selectPickup: "Select Pickup Location",
                selectDrop: "Select Drop Location",
                busNumber: "Bus Number",
                findBuses: "Find Buses",
                trackBus: "Track Bus",
                liveTracking: "Live Bus Tracking",
                mapDemo: "Interactive Map (Demo Mode)",
                mapNote: "Google Maps integration would be implemented here",
                availableBuses: "Available Buses",
                username: "Username",
                password: "Password",
                login: "Login",
                adminLogin: "Admin Login",
                driverLogin: "Driver Login",
                selectLoginType: "Select Login Type",
                adminPortal: "Admin Portal",
                driverPortal: "Driver Portal",
                demoCredentials: "Demo Credentials:",
                busDetails: "Bus Details",
                viewDetails: "View Details",
                distance: "Distance",
                speed: "Speed",
                fare: "Fare",
                driverName: "Driver",
                contact: "Contact",
                busType: "Bus Type",
                status: "Status",
                eta: "ETA",
                route: "Route",
                newUser: "New User?",
                createAdmin: "Create Admin",
                createDriver: "Create Driver",
                createAccount: "Create Account",
                fullName: "Full Name",
                age: "Age",
                gender: "Gender",
                mobile: "Mobile Number",
                email: "Email (Optional)",
                selectGender: "Select Gender",
                male: "Male",
                female: "Female",
                other: "Other",
                driverInfo: "Driver Information",
                adminInfo: "Admin Information",
                licenseNumber: "License Number",
                experience: "Experience (Years)",
                department: "Department",
                level: "Level",
                selectDepartment: "Select Department",
                selectLevel: "Select Level",
                recentSearches: "Recent Searches",
                recommendedRoutes: "Recommended Routes",
                noRecentSearches: "No recent searches yet",
                searchToSave: "Search for buses to see them here",
                clearHistory: "Clear History",
                viewAllRoutes: "View All Routes",
                searchAgain: "Search Again",
                selectDate: "Select Date",
                selectTime: "Select Time",
                selectDateTime: "Select Date & Time",
                confirm: "Confirm"
            },
            hi: {
                title: "‡§™‡§Ç‡§ú‡§æ‡§¨ ‡§¨‡§∏ ‡§ü‡•ç‡§∞‡•à‡§ï‡§∞",
                admin: "‡§è‡§°‡§Æ‡§ø‡§®",
                driver: "‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞",
                trackByRoute: "‡§∞‡•Ç‡§ü ‡§∏‡•á ‡§ü‡•ç‡§∞‡•à‡§ï ‡§ï‡§∞‡•á‡§Ç",
                trackByNumber: "‡§¨‡§∏ ‡§®‡§Ç‡§¨‡§∞ ‡§∏‡•á ‡§ü‡•ç‡§∞‡•à‡§ï ‡§ï‡§∞‡•á‡§Ç",
                pickup: "‡§™‡§ø‡§ï‡§Ö‡§™ ‡§∏‡•ç‡§•‡§æ‡§®",
                drop: "‡§°‡•ç‡§∞‡•â‡§™ ‡§∏‡•ç‡§•‡§æ‡§®",
                selectPickup: "‡§™‡§ø‡§ï‡§Ö‡§™ ‡§∏‡•ç‡§•‡§æ‡§® ‡§ö‡•Å‡§®‡•á‡§Ç",
                selectDrop: "‡§°‡•ç‡§∞‡•â‡§™ ‡§∏‡•ç‡§•‡§æ‡§® ‡§ö‡•Å‡§®‡•á‡§Ç",
                busNumber: "‡§¨‡§∏ ‡§®‡§Ç‡§¨‡§∞",
                findBuses: "‡§¨‡§∏‡•á‡§Ç ‡§ñ‡•ã‡§ú‡•á‡§Ç",
                trackBus: "‡§¨‡§∏ ‡§ü‡•ç‡§∞‡•à‡§ï ‡§ï‡§∞‡•á‡§Ç",
                liveTracking: "‡§≤‡§æ‡§á‡§µ ‡§¨‡§∏ ‡§ü‡•ç‡§∞‡•à‡§ï‡§ø‡§Ç‡§ó",
                mapDemo: "‡§á‡§Ç‡§ü‡§∞‡•à‡§ï‡•ç‡§ü‡§ø‡§µ ‡§Æ‡•à‡§™ (‡§°‡•á‡§Æ‡•ã ‡§Æ‡•ã‡§°)",
                mapNote: "‡§Ø‡§π‡§æ‡§Å Google Maps ‡§è‡§ï‡•Ä‡§ï‡§∞‡§£ ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ",
                availableBuses: "‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§¨‡§∏‡•á‡§Ç",
                username: "‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡§Æ",
                password: "‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°",
                login: "‡§≤‡•â‡§ó‡§ø‡§®",
                adminLogin: "‡§è‡§°‡§Æ‡§ø‡§® ‡§≤‡•â‡§ó‡§ø‡§®",
                driverLogin: "‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞ ‡§≤‡•â‡§ó‡§ø‡§®",
                selectLoginType: "‡§≤‡•â‡§ó‡§ø‡§® ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç",
                adminPortal: "‡§è‡§°‡§Æ‡§ø‡§® ‡§™‡•ã‡§∞‡•ç‡§ü‡§≤",
                driverPortal: "‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞ ‡§™‡•ã‡§∞‡•ç‡§ü‡§≤",
                demoCredentials: "‡§°‡•á‡§Æ‡•ã ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤:",
                busDetails: "‡§¨‡§∏ ‡§µ‡§ø‡§µ‡§∞‡§£",
                viewDetails: "‡§µ‡§ø‡§µ‡§∞‡§£ ‡§¶‡•á‡§ñ‡•á‡§Ç",
                distance: "‡§¶‡•Ç‡§∞‡•Ä",
                speed: "‡§ó‡§§‡§ø",
                fare: "‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ",
                driverName: "‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞",
                contact: "‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï",
                busType: "‡§¨‡§∏ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞",
                status: "‡§∏‡•ç‡§•‡§ø‡§§‡§ø",
                eta: "‡§™‡§π‡•Å‡§Ç‡§ö‡§®‡•á ‡§ï‡§æ ‡§∏‡§Æ‡§Ø",
                route: "‡§∞‡•Ç‡§ü",
                newUser: "‡§®‡§Ø‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ?",
                createAdmin: "‡§è‡§°‡§Æ‡§ø‡§® ‡§¨‡§®‡§æ‡§è‡§Ç",
                createDriver: "‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞ ‡§¨‡§®‡§æ‡§è‡§Ç",
                createAccount: "‡§ñ‡§æ‡§§‡§æ ‡§¨‡§®‡§æ‡§è‡§Ç",
                fullName: "‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ",
                age: "‡§â‡§Æ‡•ç‡§∞",
                gender: "‡§≤‡§ø‡§Ç‡§ó",
                mobile: "‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞",
                email: "‡§à‡§Æ‡•á‡§≤ (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)",
                selectGender: "‡§≤‡§ø‡§Ç‡§ó ‡§ö‡•Å‡§®‡•á‡§Ç",
                male: "‡§™‡•Å‡§∞‡•Å‡§∑",
                female: "‡§Æ‡§π‡§ø‡§≤‡§æ",
                other: "‡§Ö‡§®‡•ç‡§Ø",
                driverInfo: "‡§°‡•ç‡§∞‡§æ‡§á‡§µ‡§∞ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä",
                adminInfo: "‡§è‡§°‡§Æ‡§ø‡§® ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä",
                licenseNumber: "‡§≤‡§æ‡§á‡§∏‡•á‡§Ç‡§∏ ‡§®‡§Ç‡§¨‡§∞",
                experience: "‡§Ö‡§®‡•Å‡§≠‡§µ (‡§µ‡§∞‡•ç‡§∑)",
                department: "‡§µ‡§ø‡§≠‡§æ‡§ó",
                level: "‡§∏‡•ç‡§§‡§∞",
                selectDepartment: "‡§µ‡§ø‡§≠‡§æ‡§ó ‡§ö‡•Å‡§®‡•á‡§Ç",
                selectLevel: "‡§∏‡•ç‡§§‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç",
                recentSearches: "‡§π‡§æ‡§≤ ‡§ï‡•Ä ‡§ñ‡•ã‡§ú‡•á‡§Ç",
                recommendedRoutes: "‡§∏‡•Å‡§ù‡§æ‡§è ‡§ó‡§è ‡§∞‡•Ç‡§ü",
                noRecentSearches: "‡§Ö‡§≠‡•Ä ‡§§‡§ï ‡§ï‡•ã‡§à ‡§π‡§æ‡§≤ ‡§ï‡•Ä ‡§ñ‡•ã‡§ú ‡§®‡§π‡•Ä‡§Ç",
                searchToSave: "‡§¨‡§∏‡•ã‡§Ç ‡§ï‡•Ä ‡§ñ‡•ã‡§ú ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§Ø‡§π‡§æ‡§Å ‡§¶‡•á‡§ñ‡•á‡§Ç",
                clearHistory: "‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‡§∏‡§æ‡§´‡§º ‡§ï‡§∞‡•á‡§Ç",
                viewAllRoutes: "‡§∏‡§≠‡•Ä ‡§∞‡•Ç‡§ü ‡§¶‡•á‡§ñ‡•á‡§Ç",
                searchAgain: "‡§´‡§ø‡§∞ ‡§∏‡•á ‡§ñ‡•ã‡§ú‡•á‡§Ç",
                selectDate: "‡§§‡§æ‡§∞‡•Ä‡§ñ ‡§ö‡•Å‡§®‡•á‡§Ç",
                selectTime: "‡§∏‡§Æ‡§Ø ‡§ö‡•Å‡§®‡•á‡§Ç",
                selectDateTime: "‡§§‡§æ‡§∞‡•Ä‡§ñ ‡§î‡§∞ ‡§∏‡§Æ‡§Ø ‡§ö‡•Å‡§®‡•á‡§Ç",
                confirm: "‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞‡•á‡§Ç"
            },
            pa: {
                title: "‡®™‡©∞‡®ú‡®æ‡®¨ ‡®¨‡©±‡®∏ ‡®ü‡®∞‡©à‡®ï‡®∞",
                admin: "‡®ê‡®°‡®Æ‡®ø‡®®",
                driver: "‡®°‡®∞‡®æ‡®à‡®µ‡®∞",
                trackByRoute: "‡®∞‡©Ç‡®ü ‡®®‡®æ‡®≤ ‡®ü‡®∞‡©à‡®ï ‡®ï‡®∞‡©ã",
                trackByNumber: "‡®¨‡©±‡®∏ ‡®®‡©∞‡®¨‡®∞ ‡®®‡®æ‡®≤ ‡®ü‡®∞‡©à‡®ï ‡®ï‡®∞‡©ã",
                pickup: "‡®™‡®ø‡®ï‡®Ö‡©±‡®™ ‡®∏‡®•‡®æ‡®®",
                drop: "‡®°‡®∞‡®æ‡®™ ‡®∏‡®•‡®æ‡®®",
                selectPickup: "‡®™‡®ø‡®ï‡®Ö‡©±‡®™ ‡®∏‡®•‡®æ‡®® ‡®ö‡©Å‡®£‡©ã",
                selectDrop: "‡®°‡®∞‡®æ‡®™ ‡®∏‡®•‡®æ‡®® ‡®ö‡©Å‡®£‡©ã",
                busNumber: "‡®¨‡©±‡®∏ ‡®®‡©∞‡®¨‡®∞",
                findBuses: "‡®¨‡©±‡®∏‡®æ‡®Ç ‡®≤‡©±‡®≠‡©ã",
                trackBus: "‡®¨‡©±‡®∏ ‡®ü‡®∞‡©à‡®ï ‡®ï‡®∞‡©ã",
                liveTracking: "‡®≤‡®æ‡®à‡®µ ‡®¨‡©±‡®∏ ‡®ü‡®∞‡©à‡®ï‡®ø‡©∞‡®ó",
                mapDemo: "‡®á‡©∞‡®ü‡®∞‡®ê‡®ï‡®ü‡®ø‡®µ ‡®Æ‡©à‡®™ (‡®°‡©à‡®Æ‡©ã ‡®Æ‡©ã‡®°)",
                mapNote: "‡®á‡©±‡®•‡©á Google Maps ‡®è‡®ï‡©Ä‡®ï‡®∞‡®£ ‡®≤‡®æ‡®ó‡©Ç ‡®ï‡©Ä‡®§‡®æ ‡®ú‡®æ‡®µ‡©á‡®ó‡®æ",
                availableBuses: "‡®â‡®™‡®≤‡®¨‡®ß ‡®¨‡©±‡®∏‡®æ‡®Ç",
                username: "‡®Ø‡©Ç‡®ú‡®º‡®∞‡®®‡©á‡®Æ",
                password: "‡®™‡®æ‡®∏‡®µ‡®∞‡®°",
                login: "‡®≤‡®æ‡®ó‡®á‡®®",
                adminLogin: "‡®ê‡®°‡®Æ‡®ø‡®® ‡®≤‡®æ‡®ó‡®á‡®®",
                driverLogin: "‡®°‡®∞‡®æ‡®à‡®µ‡®∞ ‡®≤‡®æ‡®ó‡®á‡®®",
                selectLoginType: "‡®≤‡®æ‡®ó‡®á‡®® ‡®ï‡®ø‡®∏‡®Æ ‡®ö‡©Å‡®£‡©ã",
                adminPortal: "‡®ê‡®°‡®Æ‡®ø‡®® ‡®™‡©ã‡®∞‡®ü‡®≤",
                driverPortal: "‡®°‡®∞‡®æ‡®à‡®µ‡®∞ ‡®™‡©ã‡®∞‡®ü‡®≤",
                demoCredentials: "‡®°‡©à‡®Æ‡©ã ‡®ï‡©ç‡®∞‡©à‡®°‡©à‡®Ç‡®∏‡®º‡®≤:",
                busDetails: "‡®¨‡©±‡®∏ ‡®µ‡©á‡®∞‡®µ‡©á",
                viewDetails: "‡®µ‡©á‡®∞‡®µ‡©á ‡®µ‡©á‡®ñ‡©ã",
                distance: "‡®¶‡©Ç‡®∞‡©Ä",
                speed: "‡®ó‡®§‡©Ä",
                fare: "‡®ï‡®ø‡®∞‡®æ‡®á‡®Ü",
                driverName: "‡®°‡®∞‡®æ‡®à‡®µ‡®∞",
                contact: "‡®∏‡©∞‡®™‡®∞‡®ï",
                busType: "‡®¨‡©±‡®∏ ‡®ï‡®ø‡®∏‡®Æ",
                status: "‡®∏‡®•‡®ø‡®§‡©Ä",
                eta: "‡®™‡®π‡©Å‡©∞‡®ö‡®£ ‡®¶‡®æ ‡®∏‡®Æ‡®æ‡®Ç",
                route: "‡®∞‡©Ç‡®ü",
                newUser: "‡®®‡®µ‡®æ‡®Ç ‡®Ø‡©Ç‡®ú‡®º‡®∞?",
                createAdmin: "‡®ê‡®°‡®Æ‡®ø‡®® ‡®¨‡®£‡®æ‡®ì",
                createDriver: "‡®°‡®∞‡®æ‡®à‡®µ‡®∞ ‡®¨‡®£‡®æ‡®ì",
                createAccount: "‡®ñ‡®æ‡®§‡®æ ‡®¨‡®£‡®æ‡®ì",
                fullName: "‡®™‡©Ç‡®∞‡®æ ‡®®‡®æ‡®Æ",
                age: "‡®â‡®Æ‡®∞",
                gender: "‡®≤‡®ø‡©∞‡®ó",
                mobile: "‡®Æ‡©ã‡®¨‡®æ‡®à‡®≤ ‡®®‡©∞‡®¨‡®∞",
                email: "‡®à‡®Æ‡©á‡®≤ (‡®µ‡®ø‡®ï‡®≤‡®™‡®ø‡®ï)",
                selectGender: "‡®≤‡®ø‡©∞‡®ó ‡®ö‡©Å‡®£‡©ã",
                male: "‡®Æ‡®∞‡®¶",
                female: "‡®î‡®∞‡®§",
                other: "‡®π‡©ã‡®∞",
                driverInfo: "‡®°‡®∞‡®æ‡®à‡®µ‡®∞ ‡®ú‡®æ‡®£‡®ï‡®æ‡®∞‡©Ä",
                adminInfo: "‡®ê‡®°‡®Æ‡®ø‡®® ‡®ú‡®æ‡®£‡®ï‡®æ‡®∞‡©Ä",
                licenseNumber: "‡®≤‡®æ‡®á‡®∏‡©à‡®Ç‡®∏ ‡®®‡©∞‡®¨‡®∞",
                experience: "‡®§‡®ú‡®∞‡®¨‡®æ (‡®∏‡®æ‡®≤)",
                department: "‡®µ‡®ø‡®≠‡®æ‡®ó",
                level: "‡®™‡©±‡®ß‡®∞",
                selectDepartment: "‡®µ‡®ø‡®≠‡®æ‡®ó ‡®ö‡©Å‡®£‡©ã",
                selectLevel: "‡®™‡©±‡®ß‡®∞ ‡®ö‡©Å‡®£‡©ã",
                recentSearches: "‡®π‡®æ‡®≤ ‡®¶‡©Ä‡®Ü‡®Ç ‡®ñ‡©ã‡®ú‡®æ‡®Ç",
                recommendedRoutes: "‡®∏‡®ø‡®´‡®æ‡®∞‡®∏‡®º‡©Ä ‡®∞‡©Ç‡®ü",
                noRecentSearches: "‡®Ö‡®ú‡©á ‡®§‡©±‡®ï ‡®ï‡©ã‡®à ‡®π‡®æ‡®≤ ‡®¶‡©Ä ‡®ñ‡©ã‡®ú ‡®®‡®π‡©Ä‡®Ç",
                searchToSave: "‡®¨‡©±‡®∏‡®æ‡®Ç ‡®¶‡©Ä ‡®ñ‡©ã‡®ú ‡®ï‡®∞‡©ã ‡®Ö‡®§‡©á ‡®á‡©±‡®•‡©á ‡®µ‡©á‡®ñ‡©ã",
                clearHistory: "‡®á‡®§‡®ø‡®π‡®æ‡®∏ ‡®∏‡®æ‡®´‡®º ‡®ï‡®∞‡©ã",
                viewAllRoutes: "‡®∏‡®æ‡®∞‡©á ‡®∞‡©Ç‡®ü ‡®µ‡©á‡®ñ‡©ã",
                searchAgain: "‡®¶‡©Å‡®¨‡®æ‡®∞‡®æ ‡®ñ‡©ã‡®ú‡©ã",
                selectDate: "‡®§‡®æ‡®∞‡©Ä‡®ñ ‡®ö‡©Å‡®£‡©ã",
                selectTime: "‡®∏‡®Æ‡®æ‡®Ç ‡®ö‡©Å‡®£‡©ã",
                selectDateTime: "‡®§‡®æ‡®∞‡©Ä‡®ñ ‡®Ö‡®§‡©á ‡®∏‡®Æ‡®æ‡®Ç ‡®ö‡©Å‡®£‡©ã",
                confirm: "‡®™‡©Å‡®∏‡®º‡®ü‡©Ä ‡®ï‡®∞‡©ã"
            }
        };

        // Punjab cities with multi-language support
        const punjabCities = {
            en: [
                "Chandigarh", "Ludhiana", "Amritsar", "Jalandhar", "Patiala",
                "Bathinda", "Mohali", "Pathankot", "Hoshiarpur", "Batala",
                "Kapurthala", "Abohar", "Khanna", "Phagwara", "Muktsar",
                "Barnala", "Rajpura", "Firozpur", "Sunam", "Gurdaspur"
            ],
            hi: [
                "‡§ö‡§Ç‡§°‡•Ä‡§ó‡§¢‡§º", "‡§≤‡•Å‡§ß‡§ø‡§Ø‡§æ‡§®‡§æ", "‡§Ö‡§Æ‡•É‡§§‡§∏‡§∞", "‡§ú‡§æ‡§≤‡§Ç‡§ß‡§∞", "‡§™‡§ü‡§ø‡§Ø‡§æ‡§≤‡§æ",
                "‡§¨‡§†‡§ø‡§Ç‡§°‡§æ", "‡§Æ‡•ã‡§π‡§æ‡§≤‡•Ä", "‡§™‡§†‡§æ‡§®‡§ï‡•ã‡§ü", "‡§π‡•ã‡§∂‡§ø‡§Ø‡§æ‡§∞‡§™‡•Å‡§∞", "‡§¨‡§ü‡§æ‡§≤‡§æ",
                "‡§ï‡§™‡•Ç‡§∞‡§•‡§≤‡§æ", "‡§Ö‡§¨‡•ã‡§π‡§∞", "‡§ñ‡§®‡•ç‡§®‡§æ", "‡§´‡§ó‡§µ‡§æ‡§°‡§º‡§æ", "‡§Æ‡•Å‡§ï‡•ç‡§§‡§∏‡§∞",
                "‡§¨‡§∞‡§®‡§æ‡§≤‡§æ", "‡§∞‡§æ‡§ú‡§™‡•Å‡§∞‡§æ", "‡§´‡§ø‡§∞‡•ã‡§ú‡§™‡•Å‡§∞", "‡§∏‡•Å‡§®‡§æ‡§Æ", "‡§ó‡•Å‡§∞‡§¶‡§æ‡§∏‡§™‡•Å‡§∞"
            ],
            pa: [
                "‡®ö‡©∞‡®°‡©Ä‡®ó‡©ú‡©ç‡®π", "‡®≤‡©Å‡®ß‡®ø‡®Ü‡®£‡®æ", "‡®Ö‡©∞‡®Æ‡©ç‡®∞‡®ø‡®§‡®∏‡®∞", "‡®ú‡®≤‡©∞‡®ß‡®∞", "‡®™‡®ü‡®ø‡®Ü‡®≤‡®æ",
                "‡®¨‡®†‡®ø‡©∞‡®°‡®æ", "‡®Æ‡©ã‡®π‡®æ‡®≤‡©Ä", "‡®™‡®†‡®æ‡®®‡®ï‡©ã‡®ü", "‡®π‡©Å‡®∏‡®º‡®ø‡®Ü‡®∞‡®™‡©Å‡®∞", "‡®¨‡®ü‡®æ‡®≤‡®æ",
                "‡®ï‡®™‡©Ç‡®∞‡®•‡®≤‡®æ", "‡®Ö‡®¨‡©ã‡®π‡®∞", "‡®ñ‡©∞‡®®‡®æ", "‡®´‡®ó‡®µ‡®æ‡©ú‡®æ", "‡®Æ‡©Å‡®ï‡®§‡®∏‡®∞",
                "‡®¨‡®∞‡®®‡®æ‡®≤‡®æ", "‡®∞‡®æ‡®ú‡®™‡©Å‡®∞‡®æ", "‡®´‡®ø‡®∞‡©ã‡®ú‡®º‡®™‡©Å‡®∞", "‡®∏‡©Å‡®®‡®æ‡®Æ", "‡®ó‡©Å‡®∞‡®¶‡®æ‡®∏‡®™‡©Å‡®∞"
            ]
        };

        // Comprehensive bus database with detailed information
        const busDatabase = [
            // Chandigarh buses
            { 
                number: "PB-01-1234", 
                route: "Chandigarh - Ludhiana", 
                status: "On Time", 
                eta: "15 mins", 
                distance: "98 km", 
                speed: "65 km/h", 
                fare: "‚Çπ120", 
                driver: "Rajesh Kumar", 
                contact: "+91-98765-43210", 
                busType: "AC Deluxe",
                currentLocation: "Kharar",
                nextStop: "Kurali",
                stopsCompleted: 3,
                totalStops: 8,
                departureDate: "2024-01-20",
                departureTime: "06:00 AM",
                arrivalTime: "08:15 AM",
                lastUpdated: "2024-01-20 06:32 AM",
                trackingHistory: [
                    { location: "Chandigarh Bus Stand", timestamp: "2024-01-20 06:00 AM", status: "Departed" },
                    { location: "Mohali", timestamp: "2024-01-20 06:15 AM", status: "Arrived" },
                    { location: "Kharar", timestamp: "2024-01-20 06:30 AM", status: "Current Location" }
                ],
                busStops: [
                    { name: "Chandigarh Bus Stand", scheduledTime: "06:00 AM", actualTime: "06:00 AM", status: "completed", date: "2024-01-20" },
                    { name: "Mohali", scheduledTime: "06:15 AM", actualTime: "06:15 AM", status: "completed", date: "2024-01-20" },
                    { name: "Kharar", scheduledTime: "06:30 AM", actualTime: "06:30 AM", status: "completed", date: "2024-01-20" },
                    { name: "Kurali", scheduledTime: "06:45 AM", actualTime: null, status: "current", date: "2024-01-20" },
                    { name: "Morinda", scheduledTime: "07:00 AM", actualTime: null, status: "upcoming", date: "2024-01-20" },
                    { name: "Samrala", scheduledTime: "07:30 AM", actualTime: null, status: "upcoming", date: "2024-01-20" },
                    { name: "Khanna", scheduledTime: "07:45 AM", actualTime: null, status: "upcoming", date: "2024-01-20" },
                    { name: "Ludhiana Bus Stand", scheduledTime: "08:15 AM", actualTime: null, status: "upcoming", date: "2024-01-20" }
                ],
                nextBuses: [
                    { time: "07:30 AM", number: "PB-01-2468", date: "2024-01-20" },
                    { time: "08:00 AM", number: "PB-01-3579", date: "2024-01-20" },
                    { time: "08:30 AM", number: "PB-01-4680", date: "2024-01-20" }
                ],
                averageSpeed: "62 km/h",
                fuelLevel: "75%",
                passengerCount: "28/45",
                lastMaintenance: "2024-01-15",
                estimatedArrival: "2024-01-20 08:15 AM",
                delay: "0 mins"
            },
            { number: "PB-01-2345", route: "Chandigarh - Amritsar", status: "Delayed", eta: "25 mins", distance: "230 km", speed: "70 km/h", fare: "‚Çπ280", driver: "Sukhdev Singh", contact: "+91-98765-43211", busType: "Non-AC", departureDate: "2024-01-20", departureTime: "07:00 AM", arrivalTime: "10:30 AM", lastUpdated: "2024-01-20 07:25 AM", delay: "15 mins" },
            { number: "PB-01-3456", route: "Chandigarh - Jalandhar", status: "On Time", eta: "10 mins", distance: "144 km", speed: "68 km/h", fare: "‚Çπ180", driver: "Manpreet Kaur", contact: "+91-98765-43212", busType: "AC Deluxe", departureDate: "2024-01-20", departureTime: "08:00 AM", arrivalTime: "10:15 AM", lastUpdated: "2024-01-20 08:10 AM", delay: "0 mins" },
            { number: "PB-01-4567", route: "Chandigarh - Patiala", status: "On Time", eta: "8 mins", distance: "67 km", speed: "60 km/h", fare: "‚Çπ90", driver: "Harjeet Singh", contact: "+91-98765-43213", busType: "Non-AC", departureDate: "2024-01-20", departureTime: "09:00 AM", arrivalTime: "10:15 AM", lastUpdated: "2024-01-20 09:08 AM", delay: "0 mins" },
            { number: "PB-01-5678", route: "Chandigarh - Bathinda", status: "Running", eta: "20 mins", distance: "227 km", speed: "72 km/h", fare: "‚Çπ270", driver: "Gurpreet Singh", contact: "+91-98765-43214", busType: "AC Deluxe", departureDate: "2024-01-20", departureTime: "06:30 AM", arrivalTime: "09:45 AM", lastUpdated: "2024-01-20 09:25 AM", delay: "0 mins" },
            
            // Ludhiana buses
            { number: "PB-02-1234", route: "Ludhiana - Amritsar", status: "On Time", eta: "12 mins", distance: "132 km", speed: "66 km/h", fare: "‚Çπ160", driver: "Jasbir Singh", contact: "+91-98765-43215", busType: "AC", departureDate: "2024-01-20", departureTime: "07:30 AM", arrivalTime: "09:30 AM", lastUpdated: "2024-01-20 09:18 AM", delay: "0 mins" },
            { number: "PB-02-2345", route: "Ludhiana - Jalandhar", status: "Delayed", eta: "18 mins", distance: "46 km", speed: "55 km/h", fare: "‚Çπ60", driver: "Simran Kaur", contact: "+91-98765-43216", busType: "Non-AC", departureDate: "2024-01-20", departureTime: "08:15 AM", arrivalTime: "09:15 AM", lastUpdated: "2024-01-20 08:57 AM", delay: "10 mins" },
            { number: "PB-02-3456", route: "Ludhiana - Patiala", status: "On Time", eta: "14 mins", distance: "54 km", speed: "58 km/h", fare: "‚Çπ70", driver: "Balwinder Singh", contact: "+91-98765-43217", busType: "AC", departureDate: "2024-01-20", departureTime: "09:00 AM", arrivalTime: "10:00 AM", lastUpdated: "2024-01-20 09:46 AM", delay: "0 mins" },
            { number: "PB-02-4567", route: "Ludhiana - Bathinda", status: "Running", eta: "22 mins", distance: "129 km", speed: "64 km/h", fare: "‚Çπ150", driver: "Kuldeep Kaur", contact: "+91-98765-43218", busType: "AC Deluxe", departureDate: "2024-01-20", departureTime: "07:00 AM", arrivalTime: "09:00 AM", lastUpdated: "2024-01-20 08:38 AM", delay: "0 mins" },
            { number: "PB-02-5678", route: "Ludhiana - Mohali", status: "On Time", eta: "16 mins", distance: "108 km", speed: "62 km/h", fare: "‚Çπ130", driver: "Amarjeet Singh", contact: "+91-98765-43219", busType: "Non-AC", departureDate: "2024-01-20", departureTime: "08:30 AM", arrivalTime: "10:15 AM", lastUpdated: "2024-01-20 09:59 AM", delay: "0 mins" },
            
            // Amritsar buses
            { number: "PB-03-1234", route: "Amritsar - Jalandhar", status: "On Time", eta: "11 mins", distance: "86 km", speed: "63 km/h", fare: "‚Çπ100", driver: "Tejinder Singh", contact: "+91-98765-43220", busType: "AC" },
            { number: "PB-03-2345", route: "Amritsar - Pathankot", status: "Delayed", eta: "28 mins", distance: "107 km", speed: "59 km/h", fare: "‚Çπ120", driver: "Navdeep Kaur", contact: "+91-98765-43221", busType: "Non-AC" },
            { number: "PB-03-3456", route: "Amritsar - Batala", status: "On Time", eta: "9 mins", distance: "32 km", speed: "52 km/h", fare: "‚Çπ45", driver: "Ranjit Singh", contact: "+91-98765-43222", busType: "Non-AC" },
            { number: "PB-03-4567", route: "Amritsar - Gurdaspur", status: "Running", eta: "19 mins", distance: "51 km", speed: "56 km/h", fare: "‚Çπ65", driver: "Paramjeet Kaur", contact: "+91-98765-43223", busType: "AC" },
            { number: "PB-03-5678", route: "Amritsar - Kapurthala", status: "On Time", eta: "13 mins", distance: "54 km", speed: "61 km/h", fare: "‚Çπ70", driver: "Harbhajan Singh", contact: "+91-98765-43224", busType: "AC Deluxe" },
            
            // Jalandhar buses
            { number: "PB-04-1234", route: "Jalandhar - Hoshiarpur", status: "On Time", eta: "17 mins", distance: "38 km", speed: "54 km/h", fare: "‚Çπ50", driver: "Lakhwinder Singh", contact: "+91-98765-43225", busType: "Non-AC" },
            { number: "PB-04-2345", route: "Jalandhar - Phagwara", status: "Running", eta: "7 mins", distance: "21 km", speed: "48 km/h", fare: "‚Çπ30", driver: "Manjeet Kaur", contact: "+91-98765-43226", busType: "Non-AC" },
            { number: "PB-04-3456", route: "Jalandhar - Kapurthala", status: "On Time", eta: "12 mins", distance: "19 km", speed: "45 km/h", fare: "‚Çπ25", driver: "Davinder Singh", contact: "+91-98765-43227", busType: "AC" },
            { number: "PB-04-4567", route: "Jalandhar - Nawanshahr", status: "Delayed", eta: "21 mins", distance: "42 km", speed: "57 km/h", fare: "‚Çπ55", driver: "Baljeet Kaur", contact: "+91-98765-43228", busType: "AC" },
            { number: "PB-04-5678", route: "Jalandhar - Kartarpur", status: "On Time", eta: "15 mins", distance: "17 km", speed: "43 km/h", fare: "‚Çπ22", driver: "Sukhwinder Singh", contact: "+91-98765-43229", busType: "Non-AC" },
            
            // Patiala buses
            { number: "PB-05-1234", route: "Patiala - Bathinda", status: "Running", eta: "24 mins", distance: "160 km", speed: "67 km/h", fare: "‚Çπ190", driver: "Joginder Singh", contact: "+91-98765-43230", busType: "AC Deluxe" },
            { number: "PB-05-2345", route: "Patiala - Sangrur", status: "On Time", eta: "18 mins", distance: "48 km", speed: "59 km/h", fare: "‚Çπ60", driver: "Kulwant Kaur", contact: "+91-98765-43231", busType: "Non-AC" },
            { number: "PB-05-3456", route: "Patiala - Barnala", status: "Delayed", eta: "26 mins", distance: "75 km", speed: "61 km/h", fare: "‚Çπ85", driver: "Jaswinder Singh", contact: "+91-98765-43232", busType: "AC" },
            { number: "PB-05-4567", route: "Patiala - Rajpura", status: "On Time", eta: "8 mins", distance: "23 km", speed: "47 km/h", fare: "‚Çπ35", driver: "Harpreet Kaur", contact: "+91-98765-43233", busType: "Non-AC" },
            { number: "PB-05-5678", route: "Patiala - Samana", status: "Running", eta: "14 mins", distance: "31 km", speed: "53 km/h", fare: "‚Çπ40", driver: "Gurbachan Singh", contact: "+91-98765-43234", busType: "AC" }
        ];

        // Driver and Admin credentials
        const credentials = {
            drivers: [
                { username: "driver1", password: "pass123", name: "Rajesh Kumar", id: "D001", phone: "+91-98765-43210", experience: "8 years" },
                { username: "driver2", password: "pass123", name: "Sukhdev Singh", id: "D002", phone: "+91-98765-43211", experience: "12 years" },
                { username: "driver3", password: "pass123", name: "Manpreet Kaur", id: "D003", phone: "+91-98765-43212", experience: "6 years" },
                { username: "driver4", password: "pass123", name: "Harjeet Singh", id: "D004", phone: "+91-98765-43213", experience: "10 years" },
                { username: "driver5", password: "pass123", name: "Gurpreet Singh", id: "D005", phone: "+91-98765-43214", experience: "15 years" }
            ],
            admins: [
                { username: "admin1", password: "admin123", name: "Amarjit Singh", id: "A001", department: "Operations", level: "Senior" },
                { username: "admin2", password: "admin123", name: "Simran Kaur", id: "A002", department: "Fleet Management", level: "Manager" },
                { username: "admin3", password: "admin123", name: "Balwinder Singh", id: "A003", department: "Customer Service", level: "Supervisor" },
                { username: "admin4", password: "admin123", name: "Kuldeep Kaur", id: "A004", department: "Maintenance", level: "Head" },
                { username: "admin5", password: "admin123", name: "Tejinder Singh", id: "A005", department: "Route Planning", level: "Manager" }
            ]
        };

        let currentLoginType = '';
        let currentLanguage = 'en';
        let isDarkMode = false;
        let loggedInUser = null;
        let currentCreateType = '';
        let selectedJourneyDate = null;
        let selectedJourneyTime = null;

        // MongoDB connection configuration
        const mongoDBConnection = "mongodb+srv://punjab-bus-tracker:punjab1@cluster0.hzlpcu1.mongodb.net/";
        const databaseName = "punjab_bus_tracker";
        
        // MongoDB API endpoints (would be implemented on backend server)
        const API_BASE_URL = "https://your-backend-api.com/api"; // Replace with actual backend URL
        
        // MongoDB operations (simulated for frontend demo)
        const mongoOperations = {
            async createUser(userData, userType) {
                try {
                    // In a real application, this would make an API call to your backend
                    const response = await fetch(`${API_BASE_URL}/users`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            ...userData,
                            userType: userType,
                            createdAt: new Date().toISOString(),
                            isActive: true
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error('Failed to create user');
                    }
                    
                    return await response.json();
                } catch (error) {
                    console.error('MongoDB Create User Error:', error);
                    // For demo purposes, we'll simulate success and store locally
                    return this.simulateMongoCreate(userData, userType);
                }
            },
            
            async authenticateUser(username, password, userType) {
                try {
                    const response = await fetch(`${API_BASE_URL}/auth/login`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            username,
                            password,
                            userType
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error('Authentication failed');
                    }
                    
                    return await response.json();
                } catch (error) {
                    console.error('MongoDB Auth Error:', error);
                    // Fallback to local authentication for demo
                    return this.simulateMongoAuth(username, password, userType);
                }
            },
            
            simulateMongoCreate(userData, userType) {
                // Simulate MongoDB document creation
                const mongoDocument = {
                    _id: new Date().getTime().toString(),
                    ...userData,
                    userType: userType,
                    createdAt: new Date().toISOString(),
                    isActive: true,
                    lastLogin: null
                };
                
                // Store in localStorage to simulate database persistence
                const storageKey = `mongo_${userType}s`;
                const existingUsers = JSON.parse(localStorage.getItem(storageKey) || '[]');
                existingUsers.push(mongoDocument);
                localStorage.setItem(storageKey, JSON.stringify(existingUsers));
                
                console.log('MongoDB Simulation - User Created:', mongoDocument);
                console.log('Connection String:', mongoDBConnection);
                console.log('Database:', databaseName);
                console.log('Collection:', `${userType}s`);
                
                return { success: true, user: mongoDocument };
            },
            
            simulateMongoAuth(username, password, userType) {
                // Check localStorage first (simulated MongoDB)
                const storageKey = `mongo_${userType}s`;
                const mongoUsers = JSON.parse(localStorage.getItem(storageKey) || '[]');
                const mongoUser = mongoUsers.find(u => u.username === username && u.password === password);
                
                if (mongoUser) {
                    // Update last login
                    mongoUser.lastLogin = new Date().toISOString();
                    localStorage.setItem(storageKey, JSON.stringify(mongoUsers));
                    return { success: true, user: mongoUser };
                }
                
                // Fallback to hardcoded credentials for demo
                const userType_plural = userType === 'admin' ? 'admins' : 'drivers';
                const user = credentials[userType_plural].find(u => u.username === username && u.password === password);
                return user ? { success: true, user } : { success: false };
            }
        };

        // Initialize the application
        function init() {
            populateLocationDropdowns();
            setupEventListeners();
            updateLanguage('en');
            updateRecentSearchesDisplay();
            startClock();
        }

        // Live clock functionality
        function startClock() {
            function updateClock() {
                const now = new Date();
                const dateOptions = { 
                    weekday: 'short', 
                    year: 'numeric', 
                    month: 'short', 
                    day: 'numeric' 
                };
                const timeOptions = { 
                    hour: '2-digit', 
                    minute: '2-digit', 
                    second: '2-digit',
                    hour12: true 
                };
                
                document.getElementById('currentDate').textContent = now.toLocaleDateString('en-US', dateOptions);
                document.getElementById('currentTime').textContent = now.toLocaleTimeString('en-US', timeOptions);
            }
            
            updateClock(); // Initial call
            setInterval(updateClock, 1000); // Update every second
        }

        // Populate location dropdowns with multi-language support
        function populateLocationDropdowns() {
            updateLocationDropdowns(currentLanguage);
        }

        function updateLocationDropdowns(lang) {
            const pickupSelect = document.getElementById('pickupLocation');
            const dropSelect = document.getElementById('dropLocation');
            
            // Clear existing options except the first one
            pickupSelect.innerHTML = `<option value="" data-translate="selectPickup">Select Pickup Location</option>`;
            dropSelect.innerHTML = `<option value="" data-translate="selectDrop">Select Drop Location</option>`;
            
            punjabCities[lang].forEach((city, index) => {
                const englishCity = punjabCities.en[index];
                const pickupOption = new Option(city, englishCity);
                const dropOption = new Option(city, englishCity);
                pickupSelect.add(pickupOption);
                dropSelect.add(dropOption);
            });
        }

        // Setup event listeners
        function setupEventListeners() {
            document.getElementById('languageSelector').addEventListener('change', (e) => {
                updateLanguage(e.target.value);
            });

            document.getElementById('loginForm').addEventListener('submit', (e) => {
                e.preventDefault();
                handleLogin();
            });

            document.getElementById('createAccountForm').addEventListener('submit', (e) => {
                e.preventDefault();
                handleCreateAccount();
            });

            document.getElementById('darkModeToggle').addEventListener('click', toggleDarkMode);
            
            // Password input listeners to show/hide toggle button
            document.getElementById('password').addEventListener('input', (e) => {
                togglePasswordButton('password', 'togglePassword', e.target.value);
            });
            
            document.getElementById('createPassword').addEventListener('input', (e) => {
                togglePasswordButton('createPassword', 'toggleCreatePassword', e.target.value);
            });
        }
        
        // Toggle password visibility button display
        function togglePasswordButton(inputId, buttonId, value) {
            const button = document.getElementById(buttonId);
            if (value.length > 0) {
                button.classList.remove('hidden');
            } else {
                button.classList.add('hidden');
            }
        }
        
        // Toggle password visibility
        function togglePasswordVisibility(inputId, buttonId) {
            const input = document.getElementById(inputId);
            const button = document.getElementById(buttonId);
            const icon = button.querySelector('i');
            
            if (input.type === 'password') {
                input.type = 'text';
                icon.className = 'fas fa-eye-slash';
            } else {
                input.type = 'password';
                icon.className = 'fas fa-eye';
            }
        }

        // Update language
        function updateLanguage(lang) {
            currentLanguage = lang;
            const elements = document.querySelectorAll('[data-translate]');
            elements.forEach(element => {
                const key = element.getAttribute('data-translate');
                if (translations[lang] && translations[lang][key]) {
                    element.textContent = translations[lang][key];
                }
            });
            updateLocationDropdowns(lang);
        }

        // Dark mode toggle
        function toggleDarkMode() {
            isDarkMode = !isDarkMode;
            const body = document.body;
            const darkModeIcon = document.querySelector('#darkModeToggle i');
            
            if (isDarkMode) {
                body.classList.add('dark-mode');
                darkModeIcon.className = 'fas fa-sun text-xl';
            } else {
                body.classList.remove('dark-mode');
                darkModeIcon.className = 'fas fa-moon text-xl';
            }
        }

        // Show login options modal
        function showLoginOptions() {
            const modal = document.getElementById('loginOptionsModal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        // Close login options modal
        function closeLoginOptions() {
            const modal = document.getElementById('loginOptionsModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }

        // Show login modal
        function showLogin(type) {
            currentLoginType = type;
            const modal = document.getElementById('loginModal');
            const title = document.getElementById('loginTitle');
            
            title.textContent = type === 'admin' ? translations[currentLanguage].adminLogin : translations[currentLanguage].driverLogin;
            closeLoginOptions();
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        // Close login modal
        function closeLogin() {
            const modal = document.getElementById('loginModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        }

        // Handle login with MongoDB integration
        async function handleLogin() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (!username || !password) {
                alert('Please enter both username and password');
                return;
            }

            // Show loading state
            const submitButton = document.querySelector('#loginForm button[type="submit"]');
            const originalText = submitButton.innerHTML;
            submitButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Authenticating...';
            submitButton.disabled = true;

            try {
                // Authenticate with MongoDB
                const authResult = await mongoOperations.authenticateUser(username, password, currentLoginType);
                
                if (authResult.success) {
                    loggedInUser = { ...authResult.user, type: currentLoginType };
                    closeLogin();
                    showDashboard(authResult.user, currentLoginType);
                    
                    // Show success message
                    showNotification('Login successful!', 'success');
                } else {
                    alert('Invalid credentials. Please try again.');
                }
            } catch (error) {
                console.error('Login error:', error);
                alert('Login failed. Please try again.');
            } finally {
                // Restore button state
                submitButton.innerHTML = originalText;
                submitButton.disabled = false;
            }
        }

        // Show dashboard
        function showDashboard(user, type) {
            const modal = document.getElementById('dashboardModal');
            const title = document.getElementById('dashboardTitle');
            const content = document.getElementById('dashboardContent');
            
            title.textContent = `${type.charAt(0).toUpperCase() + type.slice(1)} Dashboard - Welcome ${user.name}`;
            
            if (type === 'admin') {
                content.innerHTML = `
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="bg-white/10 rounded-lg p-6">
                            <h3 class="text-xl font-semibold mb-4"><i class="fas fa-user-circle mr-2"></i>Profile Information</h3>
                            <p><strong>Name:</strong> ${user.name}</p>
                            <p><strong>ID:</strong> ${user.id}</p>
                            <p><strong>Department:</strong> ${user.department}</p>
                            <p><strong>Level:</strong> ${user.level}</p>
                        </div>
                        <div class="bg-white/10 rounded-lg p-6">
                            <h3 class="text-xl font-semibold mb-4"><i class="fas fa-chart-bar mr-2"></i>Fleet Statistics</h3>
                            <p><strong>Total Buses:</strong> ${busDatabase.length}</p>
                            <p><strong>Active Routes:</strong> ${new Set(busDatabase.map(b => b.route)).size}</p>
                            <p><strong>On Time:</strong> ${busDatabase.filter(b => b.status === 'On Time').length}</p>
                            <p><strong>Delayed:</strong> ${busDatabase.filter(b => b.status === 'Delayed').length}</p>
                        </div>
                        <div class="bg-white/10 rounded-lg p-6 md:col-span-2">
                            <h3 class="text-xl font-semibold mb-4"><i class="fas fa-bus mr-2"></i>Recent Bus Activities</h3>
                            <div class="space-y-2">
                                ${busDatabase.slice(0, 5).map(bus => `
                                    <div class="flex justify-between items-center py-2 border-b border-white/20">
                                        <span>${bus.number} - ${bus.route}</span>
                                        <span class="px-2 py-1 rounded text-sm ${bus.status === 'On Time' ? 'bg-green-500' : bus.status === 'Delayed' ? 'bg-yellow-500' : 'bg-blue-500'}">${bus.status}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            } else {
                const driverBuses = busDatabase.filter(bus => bus.driver === user.name);
                content.innerHTML = `
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="bg-white/10 rounded-lg p-6">
                            <h3 class="text-xl font-semibold mb-4"><i class="fas fa-user-circle mr-2"></i>Driver Profile</h3>
                            <p><strong>Name:</strong> ${user.name}</p>
                            <p><strong>ID:</strong> ${user.id}</p>
                            <p><strong>Phone:</strong> ${user.phone}</p>
                            <p><strong>Experience:</strong> ${user.experience}</p>
                        </div>
                        <div class="bg-white/10 rounded-lg p-6">
                            <h3 class="text-xl font-semibold mb-4"><i class="fas fa-bus mr-2"></i>Assigned Buses</h3>
                            <p><strong>Total Assigned:</strong> ${driverBuses.length}</p>
                            <p><strong>Currently Active:</strong> ${driverBuses.filter(b => b.status !== 'Parked').length}</p>
                        </div>
                        <div class="bg-white/10 rounded-lg p-6 md:col-span-2">
                            <h3 class="text-xl font-semibold mb-4"><i class="fas fa-route mr-2"></i>My Routes</h3>
                            <div class="space-y-2">
                                ${driverBuses.map(bus => `
                                    <div class="flex justify-between items-center py-2 border-b border-white/20">
                                        <span>${bus.number} - ${bus.route}</span>
                                        <span class="px-2 py-1 rounded text-sm ${bus.status === 'On Time' ? 'bg-green-500' : bus.status === 'Delayed' ? 'bg-yellow-500' : 'bg-blue-500'}">${bus.status}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            }
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        // Close dashboard
        function closeDashboard() {
            const modal = document.getElementById('dashboardModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }

        // Show create account modal
        function showCreateAccount(type) {
            currentCreateType = type;
            const modal = document.getElementById('createAccountModal');
            const title = document.getElementById('createAccountTitle');
            const driverFields = document.getElementById('driverSpecificFields');
            const adminFields = document.getElementById('adminSpecificFields');
            
            title.textContent = `Create ${type.charAt(0).toUpperCase() + type.slice(1)} Account`;
            
            // Show/hide specific fields based on account type
            if (type === 'driver') {
                driverFields.classList.remove('hidden');
                adminFields.classList.add('hidden');
            } else {
                adminFields.classList.remove('hidden');
                driverFields.classList.add('hidden');
            }
            
            closeLoginOptions();
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        // Close create account modal
        function closeCreateAccount() {
            const modal = document.getElementById('createAccountModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
            
            // Reset form
            document.getElementById('createAccountForm').reset();
        }

        // Handle create account with MongoDB integration
        async function handleCreateAccount() {
            const formData = {
                name: document.getElementById('createName').value,
                age: document.getElementById('createAge').value,
                gender: document.getElementById('createGender').value,
                mobile: document.getElementById('createMobile').value,
                email: document.getElementById('createEmail').value,
                username: document.getElementById('createUsername').value,
                password: document.getElementById('createPassword').value
            };

            // Validate required fields
            if (!formData.name || !formData.age || !formData.gender || !formData.mobile || !formData.username || !formData.password) {
                alert('Please fill in all required fields');
                return;
            }

            // Validate mobile number
            if (!/^[0-9]{10}$/.test(formData.mobile)) {
                alert('Please enter a valid 10-digit mobile number');
                return;
            }

            // Check if username already exists in both local and MongoDB storage
            const existingUser = [...credentials.admins, ...credentials.drivers].find(u => u.username === formData.username);
            const mongoAdmins = JSON.parse(localStorage.getItem('mongo_admins') || '[]');
            const mongoDrivers = JSON.parse(localStorage.getItem('mongo_drivers') || '[]');
            const mongoExistingUser = [...mongoAdmins, ...mongoDrivers].find(u => u.username === formData.username);
            
            if (existingUser || mongoExistingUser) {
                alert('Username already exists. Please choose a different username.');
                return;
            }

            // Show loading state
            const submitButton = document.querySelector('#createAccountForm button[type="submit"]');
            const originalText = submitButton.innerHTML;
            submitButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Creating Account...';
            submitButton.disabled = true;

            try {
                // Add type-specific data
                if (currentCreateType === 'driver') {
                    formData.license = document.getElementById('createLicense').value;
                    formData.experience = document.getElementById('createExperience').value || '0';
                    formData.phone = `+91-${formData.mobile}`;
                    formData.id = `D${String(Date.now()).slice(-6)}`;
                    formData.vehicleAssigned = null;
                    formData.routeAssigned = null;
                } else {
                    formData.department = document.getElementById('createDepartment').value || 'General';
                    formData.level = document.getElementById('createLevel').value || 'Junior';
                    formData.id = `A${String(Date.now()).slice(-6)}`;
                    formData.permissions = ['read', 'write'];
                    formData.managedRoutes = [];
                }

                // Create user in MongoDB
                const createResult = await mongoOperations.createUser(formData, currentCreateType);
                
                if (createResult.success) {
                    // Also add to local credentials for backward compatibility
                    if (currentCreateType === 'driver') {
                        credentials.drivers.push({
                            username: formData.username,
                            password: formData.password,
                            name: formData.name,
                            id: formData.id,
                            phone: formData.phone,
                            experience: `${formData.experience} years`,
                            age: formData.age,
                            gender: formData.gender,
                            email: formData.email,
                            license: formData.license
                        });
                    } else {
                        credentials.admins.push({
                            username: formData.username,
                            password: formData.password,
                            name: formData.name,
                            id: formData.id,
                            department: formData.department,
                            level: formData.level,
                            age: formData.age,
                            gender: formData.gender,
                            email: formData.email,
                            mobile: formData.mobile
                        });
                    }

                    alert(`üéâ ${currentCreateType.charAt(0).toUpperCase() + currentCreateType.slice(1)} account created successfully!\n\nüìã Account Details:\nUsername: ${formData.username}\nID: ${formData.id}\nDatabase: MongoDB Atlas\n\n‚úÖ Account is now active and ready to use!`);
                    closeCreateAccount();
                    showNotification('Account created successfully!', 'success');
                    
                    console.log('‚úÖ MongoDB Account Created:', createResult.user);
                    console.log('üîó Connection:', mongoDBConnection);
                    console.log('üóÑÔ∏è Database:', databaseName);
                    console.log('üìÅ Collection:', `${currentCreateType}s`);
                } else {
                    alert('Failed to create account. Please try again.');
                }
            } catch (error) {
                console.error('Create account error:', error);
                alert('Account creation failed. Please try again.');
            } finally {
                // Restore button state
                submitButton.innerHTML = originalText;
                submitButton.disabled = false;
            }
        }

        // Show bus details
        function showBusDetails(busNumber) {
            const bus = busDatabase.find(b => b.number === busNumber);
            if (!bus) return;
            
            const modal = document.getElementById('busDetailsModal');
            const content = document.getElementById('busDetailsContent');
            
            // Default values for buses without detailed info
            const busStops = bus.busStops || [
                { name: "Start Point", time: "06:00 AM", status: "completed" },
                { name: "Intermediate Stop 1", time: "06:30 AM", status: "current" },
                { name: "Intermediate Stop 2", time: "07:00 AM", status: "upcoming" },
                { name: "End Point", time: "07:30 AM", status: "upcoming" }
            ];
            
            const nextBuses = bus.nextBuses || [
                { time: "07:30 AM", number: "PB-XX-XXXX" },
                { time: "08:00 AM", number: "PB-XX-XXXX" },
                { time: "08:30 AM", number: "PB-XX-XXXX" }
            ];
            
            content.innerHTML = `
                <!-- Live Tracking Header -->
                <div class="bg-gradient-to-r from-blue-500/20 to-purple-500/20 rounded-lg p-4 mb-6 border border-blue-400/30">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                            <h3 class="text-lg font-semibold text-white">Live Tracking Active</h3>
                        </div>
                        <div class="text-right text-sm text-white/80">
                            <p><strong>Last Updated:</strong> ${bus.lastUpdated || 'Just now'}</p>
                            <p><strong>Journey Date:</strong> ${bus.departureDate || new Date().toISOString().split('T')[0]}</p>
                        </div>
                    </div>
                </div>

                <!-- Bus Stops Progress - Main Focus -->
                <div class="bg-white/10 rounded-lg p-6 mb-6">
                    <h3 class="text-xl font-semibold mb-4"><i class="fas fa-map-signs mr-2 text-orange-400"></i>Bus Stops Progress</h3>
                    <div class="space-y-3">
                        ${busStops.map((stop, index) => `
                            <div class="flex items-center space-x-3 ${stop.status === 'current' ? 'bg-blue-500/20 p-3 rounded-lg' : 'p-1'}">
                                <div class="flex-shrink-0">
                                    <div class="w-5 h-5 rounded-full ${
                                        stop.status === 'completed' ? 'bg-green-500' : 
                                        stop.status === 'current' ? 'bg-blue-500 animate-pulse' : 
                                        'bg-gray-500'
                                    }"></div>
                                </div>
                                <div class="flex-1">
                                    <p class="font-medium ${stop.status === 'current' ? 'text-blue-300 text-lg' : ''}">${stop.name}</p>
                                    <div class="text-sm text-white/70">
                                        <p><strong>Scheduled:</strong> ${stop.scheduledTime || stop.time}</p>
                                        ${stop.actualTime ? `<p><strong>Actual:</strong> ${stop.actualTime}</p>` : ''}
                                        ${stop.date ? `<p><strong>Date:</strong> ${stop.date}</p>` : ''}
                                    </div>
                                </div>
                                <div class="flex-shrink-0">
                                    ${stop.status === 'completed' ? '<i class="fas fa-check text-green-500 text-lg"></i>' : 
                                      stop.status === 'current' ? '<i class="fas fa-bus text-blue-500 text-lg"></i>' : 
                                      '<i class="fas fa-clock text-gray-500"></i>'}
                                </div>
                            </div>
                            ${index < busStops.length - 1 ? '<div class="w-px h-6 bg-white/20 ml-2.5"></div>' : ''}
                        `).join('')}
                    </div>
                    
                    <div class="mt-6 p-4 bg-blue-500/20 rounded-lg">
                        <p class="text-lg font-medium"><strong>Progress:</strong> ${bus.stopsCompleted || 2}/${bus.totalStops || busStops.length} stops completed</p>
                        <div class="w-full bg-gray-700 rounded-full h-3 mt-3">
                            <div class="bg-blue-500 h-3 rounded-full transition-all duration-500" style="width: ${((bus.stopsCompleted || 2) / (bus.totalStops || busStops.length)) * 100}%"></div>
                        </div>
                    </div>
                </div>

                <!-- Quick Info Grid -->
                <div class="grid md:grid-cols-3 gap-4 mb-6">
                    <div class="bg-white/10 rounded-lg p-4 text-center">
                        <i class="fas fa-bus text-2xl text-blue-400 mb-2"></i>
                        <p class="text-sm text-white/70">Bus Number</p>
                        <p class="font-semibold text-lg">${bus.number}</p>
                    </div>
                    <div class="bg-white/10 rounded-lg p-4 text-center">
                        <i class="fas fa-clock text-2xl text-green-400 mb-2"></i>
                        <p class="text-sm text-white/70">ETA</p>
                        <p class="font-semibold text-lg">${bus.eta}</p>
                    </div>
                    <div class="bg-white/10 rounded-lg p-4 text-center">
                        <i class="fas fa-rupee-sign text-2xl text-yellow-400 mb-2"></i>
                        <p class="text-sm text-white/70">Fare</p>
                        <p class="font-semibold text-lg">${bus.fare}</p>
                    </div>
                </div>

                <!-- Timing & Schedule Details -->
                <div class="bg-white/10 rounded-lg p-4 mb-4">
                    <h4 class="font-semibold mb-3"><i class="fas fa-clock mr-2 text-yellow-400"></i>Journey Timeline</h4>
                    <div class="grid md:grid-cols-3 gap-4 text-sm">
                        <div class="text-center">
                            <p class="text-white/70">Departure</p>
                            <p class="font-semibold">${bus.departureTime || 'N/A'}</p>
                            <p class="text-xs text-white/60">${bus.departureDate || 'Today'}</p>
                        </div>
                        <div class="text-center">
                            <p class="text-white/70">Expected Arrival</p>
                            <p class="font-semibold">${bus.arrivalTime || 'N/A'}</p>
                            <p class="text-xs ${bus.delay && bus.delay !== '0 mins' ? 'text-yellow-400' : 'text-green-400'}">
                                ${bus.delay ? `Delay: ${bus.delay}` : 'On Schedule'}
                            </p>
                        </div>
                        <div class="text-center">
                            <p class="text-white/70">ETA to Next Stop</p>
                            <p class="font-semibold text-blue-400">${bus.eta}</p>
                            <p class="text-xs text-white/60">Live Update</p>
                        </div>
                    </div>
                </div>

                <!-- Compact Details -->
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="bg-white/10 rounded-lg p-4">
                        <h4 class="font-semibold mb-3"><i class="fas fa-info-circle mr-2 text-cyan-400"></i>Bus Details</h4>
                        <div class="space-y-1 text-sm">
                            <p><strong>Route:</strong> ${bus.route}</p>
                            <p><strong>Type:</strong> ${bus.busType}</p>
                            <p><strong>Status:</strong> <span class="px-2 py-1 rounded text-xs ${bus.status === 'On Time' ? 'bg-green-500' : bus.status === 'Delayed' ? 'bg-yellow-500' : 'bg-blue-500'}">${bus.status}</span></p>
                            <p><strong>Current Speed:</strong> ${bus.speed}</p>
                            <p><strong>Current Location:</strong> ${bus.currentLocation || 'Updating...'}</p>
                        </div>
                    </div>
                    
                    <div class="bg-white/10 rounded-lg p-4">
                        <h4 class="font-semibold mb-3"><i class="fas fa-user mr-2 text-green-400"></i>Driver & Contact</h4>
                        <div class="space-y-1 text-sm">
                            <p><strong>Driver:</strong> ${bus.driver}</p>
                            <p><strong>Contact:</strong> ${bus.contact}</p>
                            <p><strong>Next Stop:</strong> ${bus.nextStop || 'Unknown'}</p>
                            <p><strong>Distance Remaining:</strong> ${bus.distance}</p>
                            <p><strong>Last Updated:</strong> ${bus.lastUpdated || 'Just now'}</p>
                        </div>
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div class="mt-6 flex flex-wrap gap-3 justify-center">
                    <button onclick="trackBusLive('${bus.number}')" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-satellite-dish mr-2"></i>Live Track
                    </button>
                    <button onclick="setBusAlert('${bus.number}')" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-bell mr-2"></i>Set Alert
                    </button>
                    <button onclick="shareBusInfo('${bus.number}')" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-share mr-2"></i>Share Info
                    </button>
                    <button onclick="reportIssue('${bus.number}')" class="bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-exclamation-triangle mr-2"></i>Report Issue
                    </button>
                </div>
            `;
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        // Close bus details
        function closeBusDetails() {
            const modal = document.getElementById('busDetailsModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }

        // Track by route
        function trackByRoute() {
            const pickup = document.getElementById('pickupLocation').value;
            const drop = document.getElementById('dropLocation').value;
            
            if (!pickup || !drop) {
                alert('Please select both pickup and drop locations');
                return;
            }
            
            if (pickup === drop) {
                alert('Pickup and drop locations cannot be the same');
                return;
            }
            
            // Add to recent searches
            addToRecentSearches({
                type: 'route',
                query: `${pickup} ‚Üí ${drop}`,
                pickup: pickup,
                drop: drop
            });
            
            showBusResults(`${pickup} - ${drop}`);
        }

        // Track by bus number
        function trackByNumber() {
            const busNumber = document.getElementById('busNumberInput').value.trim();
            
            if (!busNumber) {
                alert('Please enter a bus number');
                return;
            }
            
            // Add to recent searches
            addToRecentSearches({
                type: 'number',
                query: busNumber
            });
            
            showBusResults(null, busNumber);
        }

        // Recent searches management
        let recentSearches = JSON.parse(localStorage.getItem('recentSearches') || '[]');

        function addToRecentSearches(searchData) {
            // Remove if already exists
            recentSearches = recentSearches.filter(search => 
                !(search.type === searchData.type && search.query === searchData.query)
            );
            
            // Add to beginning
            recentSearches.unshift({
                ...searchData,
                timestamp: new Date().toISOString(),
                id: Date.now()
            });
            
            // Keep only last 5 searches
            recentSearches = recentSearches.slice(0, 5);
            
            // Save to localStorage
            localStorage.setItem('recentSearches', JSON.stringify(recentSearches));
            
            // Update display
            updateRecentSearchesDisplay();
        }

        function updateRecentSearchesDisplay() {
            const container = document.getElementById('recentSearchesList');
            const clearBtn = document.getElementById('clearRecentBtn');
            
            if (recentSearches.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-white/60 py-8">
                        <i class="fas fa-search text-3xl mb-3"></i>
                        <p data-translate="noRecentSearches">No recent searches yet</p>
                        <p class="text-sm mt-2" data-translate="searchToSave">Search for buses to see them here</p>
                    </div>
                `;
                clearBtn.style.display = 'none';
            } else {
                container.innerHTML = recentSearches.map(search => `
                    <div class="bg-white/10 hover:bg-white/20 rounded-lg p-3 cursor-pointer transition-all duration-300 hover-lift" onclick="repeatSearch('${search.id}')">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-white font-medium">
                                    <i class="fas ${search.type === 'route' ? 'fa-route' : 'fa-hashtag'} mr-2 text-sm"></i>
                                    ${search.type === 'route' ? search.query : `Bus ${search.query}`}
                                </p>
                                <p class="text-white/60 text-sm">${new Date(search.timestamp).toLocaleDateString()}</p>
                            </div>
                            <div class="text-right">
                                <button onclick="event.stopPropagation(); repeatSearch('${search.id}')" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-xs transition-colors">
                                    <i class="fas fa-redo mr-1"></i>
                                    <span data-translate="searchAgain">Search Again</span>
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
                clearBtn.style.display = 'block';
            }
        }

        function repeatSearch(searchId) {
            const search = recentSearches.find(s => s.id == searchId);
            if (!search) return;
            
            if (search.type === 'route') {
                const [pickup, drop] = search.query.split(' ‚Üí ');
                document.getElementById('pickupLocation').value = pickup;
                document.getElementById('dropLocation').value = drop;
                trackByRoute();
            } else {
                document.getElementById('busNumberInput').value = search.query;
                trackByNumber();
            }
        }

        function clearRecentSearches() {
            if (confirm('Are you sure you want to clear all recent searches?')) {
                recentSearches = [];
                localStorage.removeItem('recentSearches');
                updateRecentSearchesDisplay();
                showNotification('Recent searches cleared', 'success');
            }
        }

        // Recommended routes functionality
        function selectRecommendedRoute(pickup, drop) {
            document.getElementById('pickupLocation').value = pickup;
            document.getElementById('dropLocation').value = drop;
            trackByRoute();
        }

        function showAllRecommendations() {
            const allRoutes = [
                { from: 'Chandigarh', to: 'Ludhiana', fare: '‚Çπ120', buses: 5 },
                { from: 'Chandigarh', to: 'Amritsar', fare: '‚Çπ280', buses: 3 },
                { from: 'Ludhiana', to: 'Amritsar', fare: '‚Çπ160', buses: 4 },
                { from: 'Chandigarh', to: 'Jalandhar', fare: '‚Çπ180', buses: 2 },
                { from: 'Chandigarh', to: 'Patiala', fare: '‚Çπ90', buses: 3 },
                { from: 'Ludhiana', to: 'Patiala', fare: '‚Çπ70', buses: 2 },
                { from: 'Amritsar', to: 'Jalandhar', fare: '‚Çπ100', buses: 3 },
                { from: 'Patiala', to: 'Bathinda', fare: '‚Çπ190', buses: 2 }
            ];
            
            const routesList = allRoutes.map(route => `
                <div class="bg-white/10 hover:bg-white/20 rounded-lg p-3 cursor-pointer transition-all duration-300 hover-lift" onclick="selectRecommendedRoute('${route.from}', '${route.to}')">
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="text-white font-medium">${route.from} ‚Üí ${route.to}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-green-400 font-semibold">${route.fare}</p>
                            <p class="text-white/60 text-xs">${route.buses} buses</p>
                        </div>
                    </div>
                </div>
            `).join('');
            
            alert(`üöå All Available Routes:\n\n${allRoutes.map(r => `${r.from} ‚Üí ${r.to}: ${r.fare} (${r.buses} buses)`).join('\n')}\n\nClick on any route above to search for buses!`);
        }

        // Show bus results
        function showBusResults(route = null, busNumber = null) {
            const resultsDiv = document.getElementById('busResults');
            const busList = document.getElementById('busList');
            
            let filteredBuses = busDatabase;
            
            if (route) {
                const [pickup, drop] = route.split(' - ');
                filteredBuses = busDatabase.filter(bus => 
                    (bus.route.toLowerCase().includes(pickup.toLowerCase()) && bus.route.toLowerCase().includes(drop.toLowerCase())) ||
                    bus.route.toLowerCase().includes(pickup.toLowerCase()) ||
                    bus.route.toLowerCase().includes(drop.toLowerCase())
                );
            }
            
            if (busNumber) {
                filteredBuses = busDatabase.filter(bus => 
                    bus.number.toLowerCase().includes(busNumber.toLowerCase())
                );
            }
            
            busList.innerHTML = '';
            
            if (filteredBuses.length === 0) {
                busList.innerHTML = `
                    <div class="text-center text-white/70 py-8">
                        <i class="fas fa-search text-4xl mb-4"></i>
                        <p>No buses found matching your criteria</p>
                    </div>
                `;
            } else {
                filteredBuses.forEach(bus => {
                    const busCard = document.createElement('div');
                    busCard.className = 'bg-white/10 rounded-lg p-4 hover:bg-white/20 transition-all duration-300 hover-lift cursor-pointer';
                    busCard.innerHTML = `
                        <div class="flex justify-between items-center">
                            <div class="flex-1">
                                <h3 class="text-white font-semibold text-lg">${bus.number}</h3>
                                <p class="text-white/70">${bus.route}</p>
                                <p class="text-white/60 text-sm">${bus.busType} ‚Ä¢ ${bus.driver}</p>
                                <div class="flex items-center space-x-4 text-xs text-white/50 mt-1">
                                    <span><i class="fas fa-calendar-alt mr-1"></i>${bus.departureDate || 'Today'}</span>
                                    <span><i class="fas fa-clock mr-1"></i>Dep: ${bus.departureTime || 'N/A'}</span>
                                    <span><i class="fas fa-map-marker-alt mr-1"></i>Arr: ${bus.arrivalTime || 'N/A'}</span>
                                </div>
                            </div>
                            <div class="text-right">
                                <span class="inline-block px-3 py-1 rounded-full text-sm ${
                                    bus.status === 'On Time' ? 'bg-green-500' : 
                                    bus.status === 'Delayed' ? 'bg-yellow-500' : 'bg-blue-500'
                                } text-white mb-2">${bus.status}</span>
                                <p class="text-white/70">ETA: ${bus.eta}</p>
                                <p class="text-white/70">${bus.fare}</p>
                                ${bus.delay && bus.delay !== '0 mins' ? `<p class="text-yellow-400 text-xs">Delay: ${bus.delay}</p>` : ''}
                                <p class="text-white/50 text-xs mt-1">Updated: ${bus.lastUpdated || 'Just now'}</p>
                                <button onclick="showBusDetails('${bus.number}')" class="mt-2 bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm transition-colors">
                                    <span data-translate="viewDetails">View Details</span>
                                </button>
                            </div>
                        </div>
                    `;
                    busList.appendChild(busCard);
                });
            }
            
            resultsDiv.classList.remove('hidden');
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        // Action button functions for bus details
        function trackBusLive(busNumber) {
            alert(`üõ∞Ô∏è Live tracking activated for bus ${busNumber}!\n\nYou will receive real-time location updates on your device. GPS tracking is now active.`);
        }

        function setBusAlert(busNumber) {
            alert(`üîî Alert set for bus ${busNumber}!\n\nYou will be notified when:\n‚Ä¢ Bus arrives at your stop\n‚Ä¢ Bus is delayed\n‚Ä¢ Route changes occur`);
        }

        function shareBusInfo(busNumber) {
            const bus = busDatabase.find(b => b.number === busNumber);
            const shareText = `üöå Bus ${busNumber}\nRoute: ${bus.route}\nStatus: ${bus.status}\nETA: ${bus.eta}\n\nTrack live: Punjab Bus Tracker`;
            
            if (navigator.share) {
                navigator.share({
                    title: `Bus ${busNumber} Info`,
                    text: shareText,
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(shareText).then(() => {
                    alert('üìã Bus information copied to clipboard!');
                });
            }
        }

        function reportIssue(busNumber) {
            const issues = [
                'Bus is overcrowded',
                'Bus is running late',
                'AC not working',
                'Rude driver behavior',
                'Bus broke down',
                'Route deviation',
                'Other issue'
            ];
            
            const issue = prompt(`‚ö†Ô∏è Report an issue with bus ${busNumber}:\n\n` + 
                issues.map((issue, index) => `${index + 1}. ${issue}`).join('\n') + 
                '\n\nEnter issue number (1-7) or describe your issue:');
            
            if (issue) {
                alert(`‚úÖ Issue reported for bus ${busNumber}!\n\nYour report has been submitted to the transport authority. Reference ID: ${busNumber.replace('-', '')}${Date.now().toString().slice(-4)}`);
            }
        }

        // Show notification
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            
            const bgColor = type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500';
            const icon = type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle';
            
            notification.className = `${bgColor} text-white px-6 py-3 rounded-lg shadow-lg backdrop-blur-md transform transition-all duration-300 translate-y-[-20px] opacity-0`;
            notification.innerHTML = `
                <div class="flex items-center space-x-3">
                    <i class="fas ${icon}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            container.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.classList.remove('translate-y-[-20px]', 'opacity-0');
            }, 100);
            
            // Auto remove after 3 seconds
            setTimeout(() => {
                notification.classList.add('translate-y-[-20px]', 'opacity-0');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // Journey Date & Time Selector Functions
        function showJourneyDateSelector() {
            const modal = document.getElementById('journeyDateModal');
            const dateInput = document.getElementById('journeyDateInput');
            const timeInput = document.getElementById('customTimeInput');
            
            // Set minimum date to today
            const today = new Date().toISOString().split('T')[0];
            dateInput.min = today;
            
            // Set default values if none selected
            if (!selectedJourneyDate) {
                dateInput.value = today;
            } else {
                dateInput.value = selectedJourneyDate;
            }
            
            if (selectedJourneyTime && selectedJourneyTime.includes(':')) {
                // Convert 12-hour to 24-hour format for input
                const time12 = selectedJourneyTime;
                const [time, period] = time12.split(' ');
                const [hours, minutes] = time.split(':');
                let hour24 = parseInt(hours);
                
                if (period === 'PM' && hour24 !== 12) hour24 += 12;
                if (period === 'AM' && hour24 === 12) hour24 = 0;
                
                timeInput.value = `${hour24.toString().padStart(2, '0')}:${minutes}`;
            }
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        function closeJourneyDateSelector() {
            const modal = document.getElementById('journeyDateModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }

        function convertTo12Hour(time24) {
            if (!time24) return '';
            const [hours, minutes] = time24.split(':');
            const hour12 = hours % 12 || 12;
            const ampm = hours >= 12 ? 'PM' : 'AM';
            return `${hour12}:${minutes} ${ampm}`;
        }

        function confirmJourneyDateTime() {
            const dateInput = document.getElementById('journeyDateInput');
            const timeInput = document.getElementById('customTimeInput');
            
            const date = dateInput.value;
            const time24 = timeInput.value;
            
            if (!date) {
                alert('Please select a journey date');
                return;
            }
            
            if (!time24) {
                alert('Please select a journey time');
                return;
            }
            
            selectedJourneyDate = date;
            selectedJourneyTime = convertTo12Hour(time24);
            
            // Update both displays
            updateJourneyDateDisplay();
            
            // Close modal
            closeJourneyDateSelector();
            
            // Show success notification
            showNotification(`Journey scheduled for ${new Date(date).toLocaleDateString()} at ${selectedJourneyTime}`, 'success');
        }

        function updateJourneyDateDisplay() {
            const dateElement = document.getElementById('selectedJourneyDate');
            const timeElement = document.getElementById('selectedJourneyTime');
            const dateElement2 = document.getElementById('selectedJourneyDate2');
            const timeElement2 = document.getElementById('selectedJourneyTime2');
            
            if (selectedJourneyDate && selectedJourneyTime) {
                const dateObj = new Date(selectedJourneyDate);
                const shortDate = dateObj.toLocaleDateString('en-US', { 
                    month: 'short', 
                    day: 'numeric' 
                });
                
                // Update both sections
                if (dateElement) {
                    dateElement.textContent = shortDate;
                    timeElement.textContent = selectedJourneyTime;
                }
                if (dateElement2) {
                    dateElement2.textContent = shortDate;
                    timeElement2.textContent = selectedJourneyTime;
                }
            } else {
                // Reset to default text
                const elements = [
                    { date: dateElement, time: timeElement },
                    { date: dateElement2, time: timeElement2 }
                ];
                
                elements.forEach(({ date, time }) => {
                    if (date && time) {
                        date.setAttribute('data-translate', 'selectDate');
                        time.setAttribute('data-translate', 'selectTime');
                        date.textContent = translations[currentLanguage].selectDate || 'Select Date';
                        time.textContent = translations[currentLanguage].selectTime || 'Select Time';
                    }
                });
            }
        }



        // Initialize the application when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            init();
            updateJourneyDateDisplay();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97e11f05c1b6425a',t:'MTc1NzY5ODEwNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>